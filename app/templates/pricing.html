{% extends "base.html" %}
{% block content %}
<h1>Pricing</h1>
<p class="muted">Prices are monthly (demo placeholders). You can edit plans in DB or extend to real payments.</p>
<div class="grid">
  {% for p in plans %}
  <div class="card">
    <h3>{{ p['name'] }} ({{ p['code'] }})</h3>
    <div class="price">{{ p['currency'] }} {{ "%.0f"|format(p['price_monthly']) }}/mo</div>
    <ul>
      {% for f in (p['features_json']|safe)|fromjson %}
      <li>{{ f }}</li>
      {% endfor %}
    </ul>
    {% if session.get('user_id') %}
    <form method="post" action="{{ url_for('author.payments_create') }}">
      <input type="hidden" name="plan_code" value="{{ p['code'] }}" />
      <input type="hidden" name="currency" value="{{ p['currency'] }}" />
      <button class="btn" type="submit">Checkout</button>
    </form>
    <div class="muted" style="margin-top:6px; font-size:0.9rem;">
      Secure checkout via Stripe (or Mock mode if not configured).
    </div>
    {% else %}
    <a class="btn" href="{{ url_for('auth.register') }}">Create account</a>
    {% endif %}
  </div>
  {% endfor %}
</div>
{% endblock %}