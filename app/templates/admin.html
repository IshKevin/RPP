{% extends "base.html" %}
{% block content %}
<h1>Admin Console</h1>

<section class="section">
  <h2>Settings</h2>
  <form class="card form" method="post" action="{{ url_for('admin.setting_update') }}">
    <label>Key</label><input name="key" placeholder="e.g., homepage_banner_text"/>
    <label>Value</label><input name="value" placeholder="value"/>
    <button class="btn" type="submit">Save</button>
  </form>
  <div class="card">
    <strong>Current:</strong>
    <ul>
      {% for s in settings %}
        <li><code>{{ s['key'] }}</code> = {{ s['value'] }}</li>
      {% endfor %}
    </ul>
  </div>
</section>

<section class="section">
  <h2>WhatsApp Groups</h2>
  <form class="card form" method="post" action="{{ url_for('admin.whatsapp_update') }}">
    <label>Language</label>
    <select name="lang"><option value="en">en</option><option value="fr">fr</option></select>
    <label>Segment</label><input name="segment" value="pitching"/>
    <label>Group URL</label><input name="url" placeholder="https://chat.whatsapp.com/..."/>
    <button class="btn" type="submit">Add</button>
  </form>
  <div class="card">
    <ul>
      {% for g in groups %}
        <li><strong>{{ g['lang'] }}</strong> / {{ g['segment'] }} â†’ <a href="{{ g['url'] }}">{{ g['url'] }}</a></li>
      {% endfor %}
    </ul>
  </div>
</section>

<section class="section">
  <h2>Recent Users</h2>
  <div class="card">
    <table class="table">
      <tr><th>ID</th><th>Email</th><th>Name</th><th>Role</th><th>Created</th></tr>
      {% for u in users %}
        <tr><td>{{ u['id'] }}</td><td>{{ u['email'] }}</td><td>{{ u['name'] }}</td><td>{{ u['role'] }}</td><td>{{ u['created_at'] }}</td></tr>
      {% endfor %}
    </table>
  </div>
</section>

<section class="section">
  <h2>Recent Books</h2>
  <div class="card">
    <table class="table">
      <tr><th>ID</th><th>Title</th><th>Lang</th><th>Status</th><th>Views</th><th>Likes</th><th>Shares</th></tr>
      {% for b in books %}
        <tr><td>{{ b['id'] }}</td><td>{{ b['title'] }}</td><td>{{ b['language'] }}</td><td>{{ b['status'] }}</td><td>{{ b['views'] }}</td><td>{{ b['likes'] }}</td><td>{{ b['shares'] }}</td></tr>
      {% endfor %}
    </table>
  </div>
</section>
{% endblock %}
